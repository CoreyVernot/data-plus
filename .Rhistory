}
}
mods <- make_models(control_avg,nutrients,timeunits)
for(i in 1:length(nutrients)){
n <- nutrients[i]
mean_nutrient <- paste("mean_",n,sep="")
for(t in timeunits){
mod_name <- paste(n,"_",t,sep="")
print(mod_name)
sims[[mod_name]] <- simulate_new(mods[[mod_name]],newdata = data.frame(mean_nutrient = nutrient_means[i]))
mods[[mod_name]]
}
}
simulate_new(mods[[mod_name]],newdata = data.frame(mean_nutrient = nutrient_means[i]))
names(mods)
simulate(mods[[mod_name]],newdata=data.frame(mean_calories = 45))
simulate(mods[[mod_name]],newdata=data.frame("mean_calories" = 45))
simulate(mods[[mod_name]],nsim=2,newdata=data.frame("mean_calories" = 45))
sim <- simulate_new(mod = mod_list[["calories_88"]],nsim=1,seed=1126,newdata = data.frame(mean_calories = c(5000,431561,4213,632654,8493)))
sim
simulate(mods[[mod_name]],nsim=2,newdata=data.frame("mean_calories" = c(45,492))
)
simulate(mods[[mod_name]],nsim=2,newdata=data.frame("mean_calories" = 45))
mod_name
simulate(mods[["calories_88"]],nsim=2,newdata=data.frame("mean_calories" = 45))
simulate(mods[["calories_80"]],nsim=2,newdata=data.frame("mean_calories" = 45))
simulate(mods[["calories_82"]],nsim=2,newdata=data.frame("mean_calories" = 45))
simulate_new(mod = mod_list[["calories_88"]],nsim=1,seed=1126,newdata = data.frame(mean_calories = c(5000,431561,4213,632654,8493)))
mod[["calories_80"]]
mods[["calories_80"]]
mod_list[["calories_80"]]
simulate_new(mod = mod_list[[mod_name]],nsim=1,seed=1126,newdata = data.frame(mean_calories = c(5000,431561,4213,632654,8493)))
simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(mean_calories = c(5000,431561,4213,632654,8493)))
simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(mean_calories = mean_nutrient[i]))
nutrient_means
simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(mean_calories = nutrient_means[i]))
names(ret) <- c("new_id","timeunit",nutrients,nutrients)
ret <- data.frame(matrix(ncol=length(nutrients)+2))
names(ret) <- c("new_id","timeunit",nutrients,nutrients)
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",nutrients,nutrients)
ret
names(control_avg)
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
ret
ret[[mean_nutrient]] <- mean_nutrient[i]
ret
ret[[mean_nutrient]] <- nutrient_means[i]
ret
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(mean_nutrient = nutrient_means[i]))
data.frame(mean_nutrient = nutrient_means[i])
substitute(mean_nutrient)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame("mean_calories" = nutrient_means[i]))
obs
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame("mean_calories" = nutrient_means[i]))
obs
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(hello = nutrient_means[i]))
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(eval(mean_nutrient) = nutrient_means[i]))
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(eval(mean_nutrient)) = nutrient_means[i]))
eval(mean_nutrient)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(eval(mean_nutrient) = nutrient_means[i]))
data.frame(eval(mean_nutrient) = nutrient_means[i])
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nutrient_means[i]))
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nutrient_means[i])
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(nutrient_means[i]))
use <- "mean_calories"
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(use=nutrient_means[i]))
use
eval(use)
use2 <- eval(use)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(use2=nutrient_means[i]))
use2 <- parse(use)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = data.frame(   paste("mean_",n,sep="")  =nutrient_means[i]))
nd <- data.frame(mean_nutrient = nutrient_means[i])
nd
mean_nutrient
nd <- data.frame(eval(mean_nutrient) = nutrient_means[i])
53
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = list(use =nutrient_means[i]))
use
nd <- data.frame(mean_nutrient = nutrient_means[i])
nd <- data.frame[[mean_nutrient]] = nutrient_means[i])
nd <- data.frame[[mean_nutrient]] = nutrient_means[i]
nd <- data.frame
nd <- data.frame[[mean_nutrient]] nutrient_means[i]
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[i]
nd
nd <- as.data.frame(nd)
nd
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
obs
obs
nd <- data.frame()
nd[[mean_nutrient]] <- nutrient_means[i]
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[i]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
mods[[mod_name]]
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
sum_nutrient <- paste("mean_",n,sep="")
ret[[mean_nutrient]] <- nutrient_means[j]
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j] <- obs
}
}
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
sum_nutrient <- paste("mean_",n,sep="")
ret[[mean_nutrient]] <- nutrient_means[j]
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd <- as.data.frame(nd)
nd[[mean_nutrient]] <- nutrient_means[j]
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j+2] <- obs
}
}
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
sum_nutrient <- paste("mean_",n,sep="")
ret[[mean_nutrient]] <- nutrient_means[j]
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
#ret[i,j+2] <- obs
ret[i,2] <- timeunits[i]
}
}
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
#ret[i,j+2] <- obs
ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
#ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret[[timeunit]] <- timeunits
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
#ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
#ret[[timeunit]] <- timeunits
ret
timeunits
nutrients
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
#ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
#ret[[timeunit]] <- timeunits
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
#ret[[timeunit]] <- timeunits
ret
ret[[timeunit]] <- timeunits
ret[["timeunit"]] <- timeunits
ret
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
obs <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j] <- obs
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret[["timeunit"]] <- timeunits
ret
obs
rm(obs)
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
#sum_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
sum <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j+2] <- sum #these are the predicted sum columns
#ret[i,2] <- timeunits[i]
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret[["timeunit"]] <- timeunits
ret
sim_individual <- function(control_avg, nutrients, nutrient_means, timeunits, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[j]
nd <- as.data.frame(nd)
sum <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j+2] <- sum #these are the predicted sum columns
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret[["timeunit"]] <- timeunits
return(ret)
}
sim_individual(control_avg,nu)
sim_individual(control_avg,nutrients,nutrient_means,timeunits)
sim_individual(control_avg,nutrients,nutrient_means,timeunits,seed=1126)
ret
mean(ret$sum_carb)
mean(ret$sum_calories)
mean(ret$sum_sugar)
sim_individual(control_avg,nutrients,nutrient_means,timeunits,seed=1126,nsim=3)
sim_individual(control_avg,"",0,0)
sim_df <- function(control_avg, nutrients, nutrient_means, timeunits, num_indivs = 1, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
for(i in 1:num_indivs){
rbind_me <- sim_individual(control_avg, nutrients, nutrient_means, timeunits, nsim, seed)
rbind_me[["new_id"]] <- -i
ret <- rbind(ret,append_me)
}
}
sim_df(control_avg,nutrients,nutrient_means,timeunits,seed=1126,nsim=3,num_indivs = 4)
sim_df <- function(control_avg, nutrients, nutrient_means, timeunits, num_indivs = 1, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
for(i in 1:num_indivs){
rbind_me <- sim_individual(control_avg, nutrients, nutrient_means, timeunits, nsim, seed)
rbind_me[["new_id"]] <- -i
ret <- rbind(ret,rbind_me)
}
}
sim_df(control_avg,nutrients,nutrient_means,timeunits,seed=1126,nsim=3,num_indivs = 4)
sim_df <- function(control_avg, nutrients, nutrient_means, timeunits, num_indivs = 1, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
for(i in 1:num_indivs){
rbind_me <- sim_individual(control_avg, nutrients, nutrient_means, timeunits, nsim, seed)
rbind_me[["new_id"]] <- -i
ret <- rbind(ret,rbind_me)
}
return(ret)
}
sim_df(control_avg,nutrients,nutrient_means,timeunits,seed=1126,nsim=3,num_indivs = 4)
1--1
sim_df <- function(control_avg, nutrients, nutrient_means, timeunits, num_indivs = 1, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
for(i in 1:num_indivs){
rbind_me <- sim_individual(control_avg, nutrients, nutrient_means, timeunits, nsim, seed)
rbind_me[["new_id"]] <- -i
ret <- rbind(ret,rbind_me)
}
ret <- ret[-1,] #the first row is going to be a row of NA's always
return(ret)
}
sim_df(control_avg,nutrients,nutrient_means,timeunits,seed=1126,nsim=3,num_indivs = 4)
View(control_avg)
simulate_new(mod,1,newdata = data.frame("mean_calories"=45))
mod
mod <- mod[[1]]
simulate_new(mod,1,newdata = data.frame("mean_calories"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_calories"=45))
simulate_new(mod,1,newdata = data.frame("mean_calories"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new
simulate_new <- function(mod, nsim=1, seed=NULL, newdata, ...) {
pred <- predict(mod, newdata = newdata)
mod$fitted.values <- pred
sim <- simulate(object=mod, nsim=nsim, seed=seed)
for(j in 1: length(sim)){
for(i in 1:length(sim)[[j]]){
while(sim[i, j] < 0){
sim[i,j] <- 0#simulate(object=mod, nsim=1, seed=seed+as.integer(sim[i]))
}
}
}
return(sim)
}
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
simulate_new(mod,1,newdata = data.frame("mean_sugar"=45))
rm(del)
rm(indivs_and_team,guards,posts,ACC_dfl,mat,engl,scot,nire,wale)
save.image()
?rnorm
names(control_avg)
mean_models <- data.frame(matrix(nrow=2,ncol=9))
mean_models <- data.frame(matrix(nrow=2,ncol=9))
names(mean_models) <- c("fat","carb","sugar","sodium","sat_fat","protein","fiber","cholesterol","calories")
mean_models
mean_models <- data.frame(matrix(nrow=1,ncol=9))
names(mean_models) <- c("fat","carb","sugar","sodium","sat_fat","protein","fiber","cholesterol","calories")
nutrient_means <- 0
vec <- c(1,2,3,4,5)
nameS(vec) <- c
names(vec) <- c("a","e","i","o","u")
vec
vec[["e"]]
mean_models <- rep(NA,9)
names(mean_models) <- c("fat","carb","sugar","sodium","sat_fat","protein","fiber","cholesterol","calories")
mean_mod
mean_models
nutrient_means <- rep(NA,9)
names(nutrient_means) <- c("fat","carb","sugar","sodium","sat_fat","protein","fiber","cholesterol","calories")
rm(mean_models)
nutrient_means
typeof(nutrient_means)
class(nutrient_means)
nutrient_means[["calories"]] <- rgamma(1,shape = 6,scale=8400)
nutrient_means
nutrient_means
nutrient_means
nutrient_means[["calories"]] <- rgamma(1,shape = 6,scale=8400)
nutrient_means
nutrient_means[["calories"]] <- rgamma(n=1,shape = 6,scale=8400)
nutrient_means[["sugar"]] <- rgamma(n=1,shape=4,scale=900)
nutrient_means[["carb"]] <- rgamma(n=1,shape=5,scale=1040)
sim_individual <- function(control_avg, nutrients, timeunits, nsim=1, seed=NULL){
#official avg cal model is gamma(6,8400)
#official avg sugar model is gamma(4, 900)
#official avg carb model is gamma(5,1040)
nutrient_means <- rep(NA,9)
names(nutrient_means) <- c("fat","carb","sugar","sodium","sat_fat","protein","fiber","cholesterol","calories")
nutrient_means[["calories"]] <- rgamma(n=1,shape = 6,scale=8400)
nutrient_means[["sugar"]] <- rgamma(n=1,shape=4,scale=900)
nutrient_means[["carb"]] <- rgamma(n=1,shape=5,scale=1040)
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
mods <- make_models(control_avg,nutrients,timeunits)
for(j in 1:length(nutrients)){
n <- nutrients[j]
mean_nutrient <- paste("mean_",n,sep="")
for(i in 1:length(timeunits)){
mod_name <- paste(n,"_",t,sep="")
nd <- list()
nd[[mean_nutrient]] <- nutrient_means[[n]] #newdata gets a random mean from a pre-specified distribution
nd <- as.data.frame(nd)
sum <- simulate_new(mod = mod_list[[mod_name]],nsim=1,newdata = nd)
ret[i,j+2] <- sum #these are the predicted sum columns
}
ret[[mean_nutrient]] <- nutrient_means[j]
}
ret[["timeunit"]] <- timeunits
return(ret)
}
sim_df <- function(control_avg, nutrients, timeunits, num_indivs = 1, nsim=1, seed=NULL){
ret <- data.frame(matrix(ncol=2*length(nutrients)+2))
names(ret) <- c("new_id","timeunit",paste("sum_",nutrients,sep=""),paste("mean_",nutrients,sep=""))
for(i in 1:num_indivs){
rbind_me <- sim_individual(control_avg, nutrients, timeunits, nsim, seed)
rbind_me[["new_id"]] <- -i
ret <- rbind(ret,rbind_me)
}
ret <- ret[-1,] #the first row is going to be a row of NA's always
return(ret)
}
simsim <- sim_df(control_avg,nutrients,timeunits = 30:90, seed = 1126)
dim(simsim)
simsim <- sim_df(control_avg,nutrients,timeunits = 80:85, seed = 1126)
dim(simsim)
simsim
nutrients
simsim <- sim_df(control_avg,nutrients,timeunits = 80:85, seed = 1126,num_indivs = 4)
simsim
